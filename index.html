<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MEbank – Banco de Preguntas para Residencias</title>

  <link rel="stylesheet" href="css/style.css?v=12">
  <link rel="stylesheet" href="css/layout.css?v=12">
  <link rel="stylesheet" href="css/layout-mobile.css?v=12">

  <script>
    function showError(message){
      const box = document.getElementById("errorOverlay");
      document.getElementById("errorText").textContent = message;
      box.style.display = "block";
    }
    window.addEventListener("error", e => showError(e.message));
    window.addEventListener("unhandledrejection", e => showError("Promise error: "+e.reason));
  </script>
  
<style>
  /* 1. DEFINICIÓN DE COLORES (Variables) */
  :root {
    --bg-body: #f8fafc;
    --bg-card: #ffffff;
    --text-main: #1e293b;
    --text-sec: #64748b;
    --border: #e2e8f0;
    --input-bg: #ffffff;
    --shadow: rgba(0,0,0,0.05);
  }

  /* 2. OVERRIDES PARA MODO OSCURO */
  body.dark-mode {
    --bg-body: #0f172a;       /* Azul muy oscuro (Fondo) */
    --bg-card: #1e293b;       /* Azul intermedio (Tarjetas) */
    --text-main: #f1f5f9;     /* Blanco */
    --text-sec: #94a3b8;      /* Gris claro */
    --border: #334155;        /* Bordes oscuros */
    --input-bg: #1e293b;
    --shadow: rgba(0,0,0,0.3);
  }

  /* 3. APLICACIÓN GENERAL */
  body {
    background-color: var(--bg-body) !important;
    color: var(--text-main) !important;
    transition: background 0.3s, color 0.3s;
  }

  /* 4. REGLAS DE FUERZA MAYOR (Componentes Generales) */
  body.dark-mode .card, 
  body.dark-mode .materia-block, 
  body.dark-mode .nota-card,
  body.dark-mode .exam-card,
  body.dark-mode .stat-card,
  body.dark-mode .materia-box,
  body.dark-mode .modal-content,
  body.dark-mode #choice-shell,
  body.dark-mode .opcion-card,   /* <--- FIX RESOLVER */
  body.dark-mode .pregunta-box   /* <--- FIX RESOLVER */
  {
      background-color: var(--bg-card) !important;
      border-color: var(--border) !important;
      color: var(--text-main) !important;
      box-shadow: 0 4px 6px var(--shadow) !important;
  }

  /* 5. FIX TEXTOS GENERALES */
  body.dark-mode h1, body.dark-mode h2, body.dark-mode h3, 
  body.dark-mode b, body.dark-mode strong {
      color: #f8fafc !important;
  }
  
  body.dark-mode p, 
  body.dark-mode .text-muted,
  body.dark-mode div[style*="color:#64748b"], 
  body.dark-mode div[style*="color:#475569"],
  body.dark-mode label {
      color: var(--text-sec) !important;
  }

  /* 6. FIX SVG (Números de Progreso) */
  body.dark-mode text {
      fill: #f1f5f9 !important; /* Pone los números blancos */
  }
  body.dark-mode circle[stroke="#f1f5f9"],
  body.dark-mode circle[stroke="#e2e8f0"] {
      stroke: #334155 !important; /* Anillos vacíos más oscuros */
  }

  /* 7. FIX CARTELITO VERDE (Daily Streak) */
  body.dark-mode .daily-banner {
      background-color: #064e3b !important; /* Verde oscuro */
      color: #86efac !important; /* Verde flúor texto */
      border: 1px solid #065f46 !important;
  }
  body.dark-mode .daily-banner b {
      color: #ffffff !important;
  }

  /* 8. FIX INPUTS Y BOTONES */
  body.dark-mode input, 
  body.dark-mode select,
  body.dark-mode textarea {
      background-color: #334155 !important; 
      color: white !important; 
      border-color: #475569 !important;
  }
  
  body.dark-mode .btn-small,
  body.dark-mode .btn-outline-gray {
      background-color: #334155 !important;
      color: white !important;
      border-color: #475569 !important;
  }
  
  /* Hover en opciones del resolver */
  body.dark-mode .opcion-card:hover {
      background-color: #334155 !important;
  }

  /* 9. ESTILOS MODO EXAMEN (Corrección al final) */
  .option-selected-neutral {
      background-color: #eff6ff !important;
      border-color: #3b82f6 !important;
      color: #1e3a8a !important;
      font-weight: 600;
  }
  
  /* Soporte Dark Mode para selección neutra */
  body.dark-mode .option-selected-neutral {
      background-color: #172554 !important; /* Azul oscuro */
      border-color: #3b82f6 !important;
      color: #bfdbfe !important;
  }

  /* Sidebar celda respondida (sin revelar verdad) */
  .sb-answered-neutral {
      background-color: #64748b !important;
      color: white !important;
      border-color: #475569 !important;
  }
</style>


</head>

<body>

  <div id="errorOverlay" 
       style="display:none;position:fixed;top:0;left:0;right:0;z-index:9999;background:#fee2e2;
              padding:14px;color:#b91c1c;font-size:14px;">
    <b>Error:</b> <span id="errorText"></span>
  </div>

  <div class="header"><div class="wrap brand"><h1>MEbank</h1></div></div>

  <main class="wrap" id="app">
    <div style="text-align:center;margin-top:80px;">Cargando…</div>
  </main>

  <div class="footer">Vos podés ❤️</div>

  <script src="js/config.js?v=12"></script>

  <script src="js/bank.js?v=12"></script>

  <script src="js/resolver.js?v=12"></script>
  

  <script src="js/home.js?v=12"></script>
  <script src="js/choice.js?v=12"></script>
  <script src="js/examenes.js?v=12"></script>
  <script src="js/examen_setup.js?v=12"></script>
  <script src="js/stats.js?v=12"></script>
  <script src="js/notes.js?v=12"></script>
  
  <script src="js/results.js?v=12"></script>

  <script>
    document.addEventListener("DOMContentLoaded", initApp);
  </script>

</body>
</html>
